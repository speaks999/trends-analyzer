{
  "version": "1.0.0",
  "description": "Product Requirements Document for Trends Analyzer - Use this to track features and tasks",
  "tasks": [
    {
      "id": "example-1",
      "category": "functional",
      "priority": "low",
      "description": "Example task: Add error boundary component",
      "steps": [
        "Create ErrorBoundary component in app/components/",
        "Add error logging",
        "Display user-friendly error message",
        "Add error boundary to layout.tsx",
        "Write tests for error boundary"
      ],
      "passes": true,
      "notes": "Task completed. ErrorBoundary component created with full error handling, integrated into layout, and comprehensive test suite created. Test framework configured (Jest + React Testing Library). Note: Run 'npm install' to install test dependencies before running tests."
    },
    {
      "id": "tos-equal-weight",
      "category": "functional",
      "priority": "high",
      "description": "Update TOS calculation to use equal weighting (0-100 scale)",
      "steps": [
        "Update calculateTOS function in app/lib/scoring.ts to use equal weights",
        "Change formula from weighted average to: (slope + acceleration + consistency + breadth) / 4",
        "Ensure all 4 component scores are on 0-100 scale",
        "Update any comments or documentation to reflect equal weighting",
        "Run type checking and build to verify changes",
        "Test with existing queries to ensure scores are calculated correctly"
      ],
      "passes": true,
      "notes": "Task completed. TOS now uses equal weighting: (slope + acceleration + consistency + breadth) / 4. All components are already normalized to 0-100 scale. Type checking passed. Formula updated in calculateTOS function."
    },
    {
      "id": "only-30d-window",
      "category": "functional",
      "priority": "high",
      "description": "Remove 90 day and 12 month time windows, only use 30 day results",
      "steps": [
        "Update TimeWindow type to only include '30d'",
        "Remove 90d and 12m from all default window arrays",
        "Change all default window parameters from '12m' to '30d'",
        "Remove time window dropdown from frontend (app/page.tsx)",
        "Remove window state from frontend components",
        "Update API routes to only fetch/calculate 30d data",
        "Update getTrendData to only process 30d window",
        "Update all function signatures that accept window parameter",
        "Remove 90d and 12m from database queries and calculations",
        "Run type checking and build to verify changes"
      ],
      "passes": true,
      "notes": "Task completed. Removed all 90d and 12m time window references. Updated TimeWindow type to only include '30d'. Removed time window dropdown from frontend. Updated all API routes, function signatures, and type definitions to only use 30d window. Type checking and linting passed."
    },
    {
      "id": "cluster-tutorial-recommendations",
      "category": "functional",
      "priority": "high",
      "description": "Add ability to generate tutorial recommendations per opportunity cluster",
      "steps": [
        "Create generateClusterTutorialRecommendationsAI function in app/lib/recommendations-ai.ts",
        "Function should accept cluster data (queries, intent type, average score) and entrepreneur profile",
        "Design OpenAI prompt to emphasize cluster context, intent type, and cluster queries",
        "Create API endpoint /api/cluster/[clusterId]/recommendations",
        "Endpoint should fetch cluster details, get query texts and scores, fetch profile, call AI function",
        "Add Generate Tutorials button to each cluster in OpportunityClusters component",
        "Add loading state and error handling for tutorial generation",
        "Display generated tutorials in expandable section below each cluster",
        "Ensure tutorials are personalized to entrepreneur profile and cluster intent",
        "Run type checking and build to verify changes"
      ],
      "passes": true,
      "notes": "Task completed. Created generateClusterTutorialRecommendationsAI function with cluster-focused OpenAI prompt. Added /api/cluster/recommendations endpoint. Updated OpportunityClusters component with Generate Tutorials button per cluster. Added expandable UI to display tutorials. Tutorials are personalized using entrepreneur profile and address cluster theme holistically. Type checking and linting passed."
    },
    {
      "id": "tos-component-25-points",
      "category": "functional",
      "priority": "high",
      "description": "Normalize each TOS component (slope, acceleration, consistency, breadth) to 0-25 scale so total score is out of 100",
      "steps": [
        "Update calculateSlope to return 0-25 instead of 0-100 (divide by 4)",
        "Update calculateAcceleration to return 0-25 instead of 0-100 (use raw slopes for difference, then normalize to 0-25)",
        "Update calculateConsistency to return 0-25 instead of 0-100 (divide by 4)",
        "Update calculateBreadth to return 0-25 instead of 0-100 (divide by 4)",
        "Update calculateTOS to sum components instead of averaging (slope + acceleration + consistency + breadth)",
        "Update default consistency value from 50 to 0 when no data",
        "Update TrendScores component to show total score beside ranking number (e.g., '#1 75/100')",
        "Update TrendScores component to show '/25' for each component (e.g., 'Slope: 20/25')",
        "Update subtitle to say '30 days' instead of '12 months'",
        "Run type checking and build to verify changes"
      ],
      "passes": true,
      "notes": "Task completed. All TOS components now return 0-25 scale. TOS calculation sums components (not averages) to get 0-100 total. Updated display to show total score beside ranking number and '/25' for each component. Updated subtitle to reflect 30-day window. Type checking passed."
    }
  ],
  "qualityStandards": {
    "testCoverage": 80,
    "maxFunctionLength": 50,
    "maxFileLength": 300,
    "requireTypes": true,
    "requireTests": true
  },
  "feedbackLoops": [
    "npm run lint",
    "tsc --noEmit",
    "npm run build",
    "npm test"
  ]
}